<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Overview • prepost</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Overview">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">prepost</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/prepost-vignette.html">Overview</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mattblackwell/prepost/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Overview</h1>
                        <h4 data-toc-skip class="author"></h4>
            
            <h4 data-toc-skip class="date">2024-10-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mattblackwell/prepost/blob/main/vignettes/prepost-vignette.Rmd" class="external-link"><code>vignettes/prepost-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>prepost-vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Researchers are often interested in conditional average treatment
effects (CATEs): that is, an average treatment effect
<em>conditional</em> on the value of a moderator variable. In the
context of survey design, researchers face a trade-off regarding whether
to measure the relevant moderator variable before or after the
treatment. Measuring the moderator <em>before</em> treatment can create
priming bias, where respondents react differently to the treatment
because, for example, the measurement of the moderator has primed a
certain identity. Measuring the moderator <em>after</em> treatment can
lead to post-treatment bias, where the value of the moderator variable
is affected by the treatment.</p>
<p>For convenience, we use the following terms to distinguish between
different survey designs:</p>
<ul>
<li><p><strong>pre-test design</strong>: moderator is measured before
the treatment</p></li>
<li><p><strong>post-test design</strong>: moderator is measured after
the treatment</p></li>
<li><p><strong>random placement design</strong>: whether the moderator
is measured before or after treatment is randomized</p></li>
</ul>
<p>The <code>prepost</code> package provides functions to help
researchers examine the robustness of results under the
<strong>post-test</strong> or <strong>random placement</strong> designs,
including nonparametric bounds for the interaction between the treatment
and moderator, sensitivity analyses, and a Bayesian parametric model to
incorporate covariates.</p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>To illustrate, we use data from a survey experiment by Del Ponte
(2020) that uses a <strong>post-test</strong> design. In the experiment,
the author investigates how Italian citizens respond to a hypothetical
newspaper vignette describing a speech by German Chancellor Angela
Merkel. The content of the speech was randomized in a 2 (praising or
blaming Italy) x 2 (symbolic or economic theme) design. For simplicity,
here we focus on the first contrast. The primary outcome is the
respondent’s self-reported anger in response to the article. One
important moderator in this study is the strength of the respondent’s
Italian national identity, which was measured after the treatment. To
simplify, we binarize both the outcome and the moderator variables by
splitting them at the sample medians.</p>
<table style="width:99%;" class="table">
<colgroup>
<col width="7%">
<col width="64%">
<col width="28%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Original</th>
<th>Recoded</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Treatment</td>
<td>Content of hypothetical speech by Merkel: 2 (blames or praises
Italy) x 2 (symbolic or economic theme)</td>
<td>
<code>t</code> = 1 for praise, 0 for blame</td>
</tr>
<tr class="even">
<td>Moderator</td>
<td>Strength of Italian national identity, scale of 4 items each coded
0-3 (<code>itaid)</code>
</td>
<td>
<code>d</code> = 1 for above median value; 0 otherwise</td>
</tr>
<tr class="odd">
<td>Outcome</td>
<td>Self-reported anger after reading the article, scale of 2 items each
coded 0-3 (<code>angscale</code>)</td>
<td>
<code>y</code> = 1 for above median value; 0 otherwise</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sandwich.R-Forge.R-project.org/" class="external-link">sandwich</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mattblackwell/prepost" class="external-link">prepost</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">02134</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">delponte</span><span class="op">)</span></span>
<span></span>
<span><span class="va">delponte</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">t_commonality</span>, <span class="va">itaid_bin</span>, <span class="va">angry_bin</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   t_commonality itaid_bin angry_bin</span></span>
<span><span class="co">#&gt; 1             1         1         0</span></span>
<span><span class="co">#&gt; 2             0         1         0</span></span>
<span><span class="co">#&gt; 3             1         1         0</span></span>
<span><span class="co">#&gt; 4             1         1         0</span></span>
<span><span class="co">#&gt; 5             0         1         1</span></span></code></pre></div>
<p>The author finds that the speech praising rather than blaming Italy
reduces anger more among respondents with a strong national identity. To
replicate this result, we can use OLS regression with robust standard
errors, where the model contains the interaction of the treatment,
<code>t</code>, and the moderator, <code>d</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">angry_bin</span> <span class="op">~</span> <span class="va">t_commonality</span> <span class="op">*</span> <span class="va">itaid_bin</span>, data <span class="op">=</span> <span class="va">delponte</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest</a></span><span class="op">(</span>vcov <span class="op">=</span> <span class="va">vcovHC</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)              0.258427   0.046931  5.5066 5.632e-08 ***</span></span>
<span><span class="co">#&gt; t_commonality           -0.077871   0.065694 -1.1854 0.2363882    </span></span>
<span><span class="co">#&gt; itaid_bin                0.153338   0.059260  2.5875 0.0099224 ** </span></span>
<span><span class="co">#&gt; t_commonality:itaid_bin -0.270168   0.076944 -3.5112 0.0004828 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>However, this model does not account for the possibility of
<strong>post-treatment bias</strong>. What if the respondents’ strength
of Italian national identity was affected by reading about the speech
praising versus blaming Italy?</p>
<p>We can of course look at the average treatment effect on the
moderator variable itself:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">itaid_bin</span> <span class="op">~</span> <span class="va">t_commonality</span>, data <span class="op">=</span> <span class="va">delponte</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest</a></span><span class="op">(</span>vcov <span class="op">=</span> <span class="va">vcovHC</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   0.677536   0.028238 23.9941   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; t_commonality 0.061594   0.038744  1.5898   0.1125    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>However, a null result on such a test does not rule out the
possibility of post-treatment bias, since individual-level effects may
“cancel out” in the aggregate. Indeed, when exclude respondents with low
levels of political sophistication (defined as either being in the
bottom quartile on the political knowledge scale or not being regular
readers of the newspaper blog where the experiment was advertised), we
do observe a statistically significant treatment effect on the
moderator. Reading about a speech where Merkel praises Italy (versus
blames Italy) causes respondents to report higher levels of Italian
national identity.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delponte_subset</span> <span class="op">&lt;-</span> <span class="va">delponte</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sopscale</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">sopscale</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         <span class="va">Corriere</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">itaid_bin</span> <span class="op">~</span> <span class="va">t_commonality</span>, data <span class="op">=</span> <span class="va">delponte_subset</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest</a></span><span class="op">(</span>vcov <span class="op">=</span> <span class="va">vcovHC</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   0.685345   0.030620 22.3823  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; t_commonality 0.086207   0.041278  2.0884  0.03731 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="nonparametric-bounds">Nonparametric bounds<a class="anchor" aria-label="anchor" href="#nonparametric-bounds"></a>
</h2>
<p>To implement the sharp bounds derived in [CITE OUR PAPER], we can use
the <code><a href="../reference/post_bounds.html">post_bounds()</a></code> function, which returns a list containing
the values of the bounds for the interaction between the treatment and
the moderator, as well as the external confidence intervals.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bounds_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/post_bounds.html">post_bounds</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">angry_bin</span> <span class="op">~</span> <span class="va">t_commonality</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">delponte_subset</span>,</span>
<span>                        moderator <span class="op">=</span> <span class="op">~</span> <span class="va">itaid_bin</span><span class="op">)</span></span>
<span><span class="co">#&gt; Bootstrap running...</span></span>
<span><span class="co">#&gt; 0% |==                  | 100%</span></span>
<span><span class="co">#&gt; 0% |====                | 100%</span></span>
<span><span class="co">#&gt; 0% |======              | 100%</span></span>
<span><span class="co">#&gt; 0% |========            | 100%</span></span>
<span><span class="co">#&gt; 0% |==========          | 100%</span></span>
<span><span class="co">#&gt; 0% |============        | 100%</span></span>
<span><span class="co">#&gt; 0% |==============      | 100%</span></span>
<span><span class="co">#&gt; 0% |================    | 100%</span></span>
<span><span class="co">#&gt; 0% |==================  | 100%</span></span>
<span><span class="co">#&gt; 0% |====================| 100%</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bounds_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt; [1] -1.391705</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt; [1] 1.391705</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci_lower</span></span>
<span><span class="co">#&gt; [1] -1.449048</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci_upper</span></span>
<span><span class="co">#&gt; [1] 1.449048</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $post_est</span></span>
<span><span class="co">#&gt; [1] -0.262191</span></span></code></pre></div>
<p>By default, the bounds are calculated assuming only randomization of
treatment. However, making additional assumptions can tighten the bounds
considerably. The function allows the user to toggle either of the
following assumptions:</p>
<ul>
<li><p><code>moderator_mono</code>: Monotonicity of the post-test
effect, i.e., measuring the moderator after treatment moves that
moderator in one direction. Defaults to <code>NULL</code>.</p></li>
<li><p><code>stable_mod</code>: Stable moderator under control, i.e.,
the moderator under the control condition is not affected by the timing
of treatment. Defaults to <code>FALSE</code>.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bounds_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/post_bounds.html">post_bounds</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">angry_bin</span> <span class="op">~</span> <span class="va">t_commonality</span>,</span>
<span>  data <span class="op">=</span> <span class="va">delponte_subset</span>,</span>
<span>  moderator <span class="op">=</span> <span class="op">~</span> <span class="va">itaid_bin</span>,</span>
<span>  moderator_mono <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stable_mod <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Bootstrap running...</span></span>
<span><span class="co">#&gt; 0% |==                  | 100%</span></span>
<span><span class="co">#&gt; 0% |====                | 100%</span></span>
<span><span class="co">#&gt; 0% |======              | 100%</span></span>
<span><span class="co">#&gt; 0% |========            | 100%</span></span>
<span><span class="co">#&gt; 0% |==========          | 100%</span></span>
<span><span class="co">#&gt; 0% |============        | 100%</span></span>
<span><span class="co">#&gt; 0% |==============      | 100%</span></span>
<span><span class="co">#&gt; 0% |================    | 100%</span></span>
<span><span class="co">#&gt; 0% |==================  | 100%</span></span>
<span><span class="co">#&gt; 0% |====================| 100%</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bounds_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt; [1] -0.3802878</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt; [1] -0.2203843</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci_lower</span></span>
<span><span class="co">#&gt; [1] -0.5212285</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci_upper</span></span>
<span><span class="co">#&gt; [1] -0.09330538</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $post_est</span></span>
<span><span class="co">#&gt; [1] -0.262191</span></span></code></pre></div>
<p>We can also incorporate covariates using formula syntax. (Note: in
order to incorporate covariates, the argument <code>stable_mod</code>
must be set to <code>TRUE</code>.)</p>
</div>
<div class="section level2">
<h2 id="bayesian-parametric-model">Bayesian parametric model<a class="anchor" aria-label="anchor" href="#bayesian-parametric-model"></a>
</h2>
<p>Incorporating covariates into the nonparametric bounds is possible,
but a Bayesian parametric model gives more flexibility.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gibbs_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepost_gibbs_nocovar.html">prepost_gibbs_nocovar</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">angry_bin</span> <span class="op">~</span> <span class="va">t_commonality</span>,</span>
<span>  data <span class="op">=</span> <span class="va">delponte_subset</span>,</span>
<span>  prepost <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  moderator <span class="op">=</span> <span class="op">~</span> <span class="va">itaid_bin</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">250</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gibbs_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepost_gibbs.html">prepost_gibbs</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">angry_bin</span> <span class="op">~</span> <span class="va">t_commonality</span>,</span>
<span>  data <span class="op">=</span> <span class="va">delponte_subset</span>,</span>
<span>  prepost <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  moderator <span class="op">=</span> <span class="op">~</span> <span class="va">itaid_bin</span>,</span>
<span>  covariates <span class="op">=</span> <span class="op">~</span> <span class="va">north</span> <span class="op">+</span> <span class="va">satisf</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">250</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can compare the estimate and credible interval of the quantity of
interest (the interaction between the treatment and the moderator) with
and without covariates. We provide two different estimates of this
quantity: <code>delta.1</code> is the in-sample estimate and
<code>delta.2</code> is the population estimate.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">gibbs_1</span><span class="op">$</span><span class="va">delta.1</span>,</span>
<span>                   <span class="va">gibbs_1</span><span class="op">$</span><span class="va">delta.2</span>,</span>
<span>                   <span class="va">gibbs_2</span><span class="op">$</span><span class="va">delta.1</span>,</span>
<span>                   <span class="va">gibbs_2</span><span class="op">$</span><span class="va">delta.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">get_ci</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">mean</span>, <span class="op">~</span><span class="va">lowerCI</span>, <span class="op">~</span><span class="va">upperCI</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.025</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">delta_list</span>, <span class="va">get_ci</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"In-sample delta, w/o covars"</span>,</span>
<span>    <span class="st">"Population delta, w/o covars"</span>,</span>
<span>    <span class="st">"In-sample delta, with covars"</span>,</span>
<span>    <span class="st">"Population delta, with covars"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mean</span>,</span>
<span>    y <span class="op">=</span> <span class="va">model</span>,</span>
<span>    xmin <span class="op">=</span> <span class="va">lowerCI</span>,</span>
<span>    xmax <span class="op">=</span> <span class="va">upperCI</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, </span>
<span>       y <span class="op">=</span> <span class="st">""</span>, </span>
<span>       title <span class="op">=</span> <span class="st">"Bayesian credible intervals"</span><span class="op">)</span></span></code></pre></div>
<p><img src="prepost-vignette_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Blackwell, Jacob Brown, Sophie Hill.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
